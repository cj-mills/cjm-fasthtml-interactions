# Step Flow


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## Step Definition

The
[`Step`](https://cj-mills.github.io/cjm-fasthtml-interactions/patterns/step_flow.html#step)
class defines a single step in a multi-step workflow. Each step has: -
Unique identifier - Title for display - Render function that generates
the UI - Optional validation function - Optional data loader for
fetching required data - State keys that this step manages

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-interactions/blob/main/cjm_fasthtml_interactions/patterns/step_flow.py#L25"
target="_blank" style="float:right; font-size:smaller">source</a>

### Step

>  Step (id:str, title:str, render:Callable[[cjm_fasthtml_interactions.core.
>            context.InteractionContext],Any],
>            validate:Optional[Callable[[Dict[str,Any]],bool]]=None,
>            data_loader:Optional[Callable[[Any],Dict[str,Any]]]=None,
>            data_keys:List[str]=<factory>, can_skip:bool=False,
>            show_back:bool=True, show_cancel:bool=True,
>            next_button_text:str='Continue')

*Definition of a single step in a multi-step workflow.*

## StepFlow Class

The
[`StepFlow`](https://cj-mills.github.io/cjm-fasthtml-interactions/patterns/step_flow.html#stepflow)
class manages a multi-step workflow. It: - Tracks current step - Manages
navigation between steps - Integrates with `WorkflowSession` for state
persistence - Generates routes automatically - Provides resumability
(returns to last valid step on page load)

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-interactions/blob/main/cjm_fasthtml_interactions/patterns/step_flow.py#L48"
target="_blank" style="float:right; font-size:smaller">source</a>

### StepFlow

>  StepFlow (flow_id:str, steps:List[__main__.Step], container_id:str='step-
>                flow-container',
>                on_complete:Optional[Callable[[Dict[str,Any],Any],Any]]=None,
>                show_progress:bool=False, wrap_in_form:bool=True)

*Manage multi-step workflows with automatic route generation and state
management.*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>flow_id</td>
<td>str</td>
<td></td>
<td>Unique identifier for this workflow</td>
</tr>
<tr>
<td>steps</td>
<td>List</td>
<td></td>
<td>List of step definitions</td>
</tr>
<tr>
<td>container_id</td>
<td>str</td>
<td>step-flow-container</td>
<td>HTML ID for content container</td>
</tr>
<tr>
<td>on_complete</td>
<td>Optional</td>
<td>None</td>
<td>Completion handler</td>
</tr>
<tr>
<td>show_progress</td>
<td>bool</td>
<td>False</td>
<td>Whether to show progress indicator</td>
</tr>
<tr>
<td>wrap_in_form</td>
<td>bool</td>
<td>True</td>
<td>Whether to wrap content + navigation in a form</td>
</tr>
</tbody>
</table>

## Step Management Methods

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-interactions/blob/main/cjm_fasthtml_interactions/patterns/step_flow.py#L73"
target="_blank" style="float:right; font-size:smaller">source</a>

### StepFlow.get_step

>  StepFlow.get_step (step_id:str)

*Get step by ID.*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>step_id</td>
<td>str</td>
<td>Step identifier</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>Optional</strong></td>
<td><strong>Step object or None</strong></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-interactions/blob/main/cjm_fasthtml_interactions/patterns/step_flow.py#L84"
target="_blank" style="float:right; font-size:smaller">source</a>

### StepFlow.get_step_index

>  StepFlow.get_step_index (step_id:str)

*Get step index by ID.*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>step_id</td>
<td>str</td>
<td>Step identifier</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>Optional</strong></td>
<td><strong>Step index or None</strong></td>
</tr>
</tbody>
</table>

## Navigation Methods

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-interactions/blob/main/cjm_fasthtml_interactions/patterns/step_flow.py#L92"
target="_blank" style="float:right; font-size:smaller">source</a>

### StepFlow.get_current_step_id

>  StepFlow.get_current_step_id (sess:Any)

*Get current step ID from session.*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>sess</td>
<td>Any</td>
<td>FastHTML session object</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>str</strong></td>
<td><strong>Current step ID</strong></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-interactions/blob/main/cjm_fasthtml_interactions/patterns/step_flow.py#L106"
target="_blank" style="float:right; font-size:smaller">source</a>

### StepFlow.set_current_step

>  StepFlow.set_current_step (sess:Any, step_id:str)

*Set current step in session.*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>sess</td>
<td>Any</td>
<td>FastHTML session object</td>
</tr>
<tr>
<td>step_id</td>
<td>str</td>
<td>Step ID to set as current</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>None</strong></td>
<td></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-interactions/blob/main/cjm_fasthtml_interactions/patterns/step_flow.py#L125"
target="_blank" style="float:right; font-size:smaller">source</a>

### StepFlow.get_next_step_id

>  StepFlow.get_next_step_id (current_step_id:str)

*Get the ID of the next step.*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>current_step_id</td>
<td>str</td>
<td>Current step ID</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>Optional</strong></td>
<td><strong>Next step ID or None if last step</strong></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-interactions/blob/main/cjm_fasthtml_interactions/patterns/step_flow.py#L136"
target="_blank" style="float:right; font-size:smaller">source</a>

### StepFlow.get_previous_step_id

>  StepFlow.get_previous_step_id (current_step_id:str)

*Get the ID of the previous step.*

<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 38%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>current_step_id</td>
<td>str</td>
<td>Current step ID</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>Optional</strong></td>
<td><strong>Previous step ID or None if first step</strong></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-interactions/blob/main/cjm_fasthtml_interactions/patterns/step_flow.py#L147"
target="_blank" style="float:right; font-size:smaller">source</a>

### StepFlow.is_last_step

>  StepFlow.is_last_step (step_id:str)

*Check if step is the last step.*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>step_id</td>
<td>str</td>
<td>Step ID to check</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>bool</strong></td>
<td><strong>True if this is the last step</strong></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-interactions/blob/main/cjm_fasthtml_interactions/patterns/step_flow.py#L156"
target="_blank" style="float:right; font-size:smaller">source</a>

### StepFlow.is_first_step

>  StepFlow.is_first_step (step_id:str)

*Check if step is the first step.*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>step_id</td>
<td>str</td>
<td>Step ID to check</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>bool</strong></td>
<td><strong>True if this is the first step</strong></td>
</tr>
</tbody>
</table>

## State Management Methods

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-interactions/blob/main/cjm_fasthtml_interactions/patterns/step_flow.py#L165"
target="_blank" style="float:right; font-size:smaller">source</a>

### StepFlow.get_workflow_state

>  StepFlow.get_workflow_state (sess:Any)

*Get all workflow state from session.*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>sess</td>
<td>Any</td>
<td>FastHTML session object</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>Dict</strong></td>
<td><strong>All workflow state</strong></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-interactions/blob/main/cjm_fasthtml_interactions/patterns/step_flow.py#L174"
target="_blank" style="float:right; font-size:smaller">source</a>

### StepFlow.update_workflow_state

>  StepFlow.update_workflow_state (sess:Any, updates:Dict[str,Any])

*Update workflow state with new values.*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>sess</td>
<td>Any</td>
<td>FastHTML session object</td>
</tr>
<tr>
<td>updates</td>
<td>Dict</td>
<td>State updates</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>None</strong></td>
<td></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-interactions/blob/main/cjm_fasthtml_interactions/patterns/step_flow.py#L194"
target="_blank" style="float:right; font-size:smaller">source</a>

### StepFlow.clear_workflow

>  StepFlow.clear_workflow (sess:Any)

*Clear all workflow state.*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>sess</td>
<td>Any</td>
<td>FastHTML session object</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>None</strong></td>
<td></td>
</tr>
</tbody>
</table>

## Context and Rendering Methods

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-interactions/blob/main/cjm_fasthtml_interactions/patterns/step_flow.py#L203"
target="_blank" style="float:right; font-size:smaller">source</a>

### StepFlow.create_context

>  StepFlow.create_context (request:Any, sess:Any, step:__main__.Step)

*Create interaction context for a step.*

<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 38%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>request</td>
<td>Any</td>
<td>FastHTML request object</td>
</tr>
<tr>
<td>sess</td>
<td>Any</td>
<td>FastHTML session object</td>
</tr>
<tr>
<td>step</td>
<td>Step</td>
<td>Current step</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>InteractionContext</strong></td>
<td><strong>Interaction context for rendering</strong></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-interactions/blob/main/cjm_fasthtml_interactions/patterns/step_flow.py#L226"
target="_blank" style="float:right; font-size:smaller">source</a>

### StepFlow.render_progress

>  StepFlow.render_progress (sess:Any)

*Render progress indicator showing all steps.*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>sess</td>
<td>Any</td>
<td>FastHTML session object</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>FT</strong></td>
<td><strong>Progress indicator or empty Div</strong></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-interactions/blob/main/cjm_fasthtml_interactions/patterns/step_flow.py#L254"
target="_blank" style="float:right; font-size:smaller">source</a>

### StepFlow.render_step_content

>  StepFlow.render_step_content (step_obj:__main__.Step,
>                                    ctx:cjm_fasthtml_interactions.core.context.
>                                    InteractionContext, next_route:str,
>                                    back_route:Optional[str]=None,
>                                    cancel_route:Optional[str]=None)

*Render step content with optional progress indicator and navigation.*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>step_obj</td>
<td>Step</td>
<td></td>
<td>Step to render</td>
</tr>
<tr>
<td>ctx</td>
<td>InteractionContext</td>
<td></td>
<td>Interaction context</td>
</tr>
<tr>
<td>next_route</td>
<td>str</td>
<td></td>
<td>Route for next/submit</td>
</tr>
<tr>
<td>back_route</td>
<td>Optional</td>
<td>None</td>
<td>Route for back</td>
</tr>
<tr>
<td>cancel_route</td>
<td>Optional</td>
<td>None</td>
<td>Route for cancel</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>FT</strong></td>
<td></td>
<td><strong>Complete step content with optional progress and
navigation</strong></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-interactions/blob/main/cjm_fasthtml_interactions/patterns/step_flow.py#L299"
target="_blank" style="float:right; font-size:smaller">source</a>

### StepFlow.render_navigation

>  StepFlow.render_navigation (step_id:str, next_route:str,
>                                  back_route:Optional[str]=None,
>                                  cancel_route:Optional[str]=None)

*Render navigation buttons for a step.*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>step_id</td>
<td>str</td>
<td></td>
<td>Current step ID</td>
</tr>
<tr>
<td>next_route</td>
<td>str</td>
<td></td>
<td>Route for next/submit action</td>
</tr>
<tr>
<td>back_route</td>
<td>Optional</td>
<td>None</td>
<td>Route for back action</td>
</tr>
<tr>
<td>cancel_route</td>
<td>Optional</td>
<td>None</td>
<td>Route for cancel action</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>FT</strong></td>
<td></td>
<td><strong>Navigation button container</strong></td>
</tr>
</tbody>
</table>

## Route Generation

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-interactions/blob/main/cjm_fasthtml_interactions/patterns/step_flow.py#L367"
target="_blank" style="float:right; font-size:smaller">source</a>

### StepFlow.create_router

>  StepFlow.create_router (prefix:str='')

*Create FastHTML router with generated routes for this flow.*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>prefix</td>
<td>str</td>
<td></td>
<td>URL prefix for routes (e.g., “/transcription”)</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>APIRouter</strong></td>
<td></td>
<td><strong>APIRouter with generated routes</strong></td>
</tr>
</tbody>
</table>

## Usage Example

Here’s a complete example showing how to create a multi-step workflow:

``` python
# Example: Simple 3-step workflow
from fasthtml.common import Div, H2, P, Form, Input, Label

# Define render functions for each step
def render_step1(ctx: InteractionContext):
    """Render first step - collect name."""
    current_name = ctx.get("name", "")
    return Div(
        H2("Step 1: Enter Your Name"),
        Label("Name:"),
        Input(name="name", value=current_name, required=True)
    )

def render_step2(ctx: InteractionContext):
    """Render second step - collect email."""
    name = ctx.get("name", "User")
    current_email = ctx.get("email", "")
    return Div(
        H2(f"Step 2: Hi {name}, enter your email"),
        Label("Email:"),
        Input(name="email", type="email", value=current_email, required=True)
    )

def render_step3(ctx: InteractionContext):
    """Render third step - confirm."""
    name = ctx.get("name", "")
    email = ctx.get("email", "")
    return Div(
        H2("Step 3: Confirm"),
        P(f"Name: {name}"),
        P(f"Email: {email}")
    )

# Define completion handler
def on_complete(state: Dict[str, Any], request):
    """Handle workflow completion."""
    return Div(
        H2("Success!"),
        P(f"Welcome {state.get('name')}!"),
        P(f"We'll email you at {state.get('email')}")
    )

# Create the step flow with progress indicator
registration_flow = StepFlow(
    flow_id="registration",
    steps=[
        Step(
            id="name",
            title="Enter Name",
            render=render_step1,
            data_keys=["name"]
        ),
        Step(
            id="email",
            title="Enter Email",
            render=render_step2,
            data_keys=["email"]
        ),
        Step(
            id="confirm",
            title="Confirm",
            render=render_step3,
            next_button_text="Complete Registration"
        )
    ],
    on_complete=on_complete,
    show_progress=True  # Enable progress indicator
)

# Generate router
registration_router = registration_flow.create_router(prefix="/register")

# In your FastHTML app, register the router:
# from cjm_fasthtml_app_core.core.routing import register_routes
# register_routes(app, registration_router)
#
# Or directly:
# registration_router.to_app(app)
```

``` python
# Test step flow navigation
print(f"Flow has {len(registration_flow.steps)} steps")
print(f"First step: {registration_flow.steps[0].id}")
print(f"Last step: {registration_flow.steps[-1].id}")
print(f"Next after 'name': {registration_flow.get_next_step_id('name')}")
print(f"Previous before 'email': {registration_flow.get_previous_step_id('email')}")
```

    Flow has 3 steps
    First step: name
    Last step: confirm
    Next after 'name': email
    Previous before 'email': name
